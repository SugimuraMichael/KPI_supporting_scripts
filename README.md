# KPI_supporting_scripts
Supporting scripts for KPI analysis

1) generating lead time matrixes (needs to be run quarterly to generate new matricies) 
2) generating ASNs for KPIs 6 and 7 which will be placed on the google sheets (run every 1-2 months, keep track based on the 2 month lag time for the KPI)

## 1) generating lead time matrixes 
### merging 2017 Q1 and Q2 LT matrix.py

this file is used to generate LT matrixes based on individual matricies generated by FSU (Ben Smith)

Things that need to be adjusted overtime

Quarters variable, a list of strings that indicate the quarters that will appear in the lead time matrix. This one is set for Q1, Q2, and Q3 of 2017, will need to be updated accordingly overtime

```
quarters = ['2017-01 leadtimes', '2017-02 leadtimes', '2017-03 leadtimes']
```

directory variable: string that points to a folder where lead time matricies will be stored, 

```
directory = 'C:/Users/585000/Desktop/PCFSM/FLT matrix calculations/quarter_matricies'
```

Final variable to change is the save location, currently noted in this line. I usually just change the file name to match whenever the new matrix is generated so I can keep track of it. 
```
matrix.to_csv(directory + '/matrix_tests/matrix_test_7_27_07_2.csv', index=False)
```

### NOTES: 

```
directory = 'C:/Users/585000/Desktop/PCFSM/FLT matrix calculations/quarter_matricies'

os.chdir(directory)

filelist2 = glob.glob(os.path.join('*.csv*'))
```
glob.glob gathers all of the files within a directory. So make sure only quarter matricies (or the most updated versions) are in the directory it is pointed at.

## 2) generating ASNs for KPIs 6 and 7 which will be placed on the google sheets
### generate_ASNs_for_planned_costs.py

This file intakes a PAD COR dataset and outputs a list of ASNs for a specified period of time which need to be loaded to google sheets

matrix_file is the name of the PAD COR dataset of reference, 
month_period is a reference to the specific month. In this case it would be  referencing may 2017. You can also include multiple months, 

```
### USE PAD COR not pad cor ppm
matrix_file = 'PAD COR 6_26_17.csv'
#set reporting month, this matches up with KPI 6 and 7,
month_period = ['2017-05']
```
To include multiple months just add elements to the month_period string
```
month_period = ['2017-05','2017-06]
```
This would have the file run for may and june


save_loc specifies the desired save location. a future addition to this script could be to automatically add to the google sheet where the ASNs are stored. 
save_name: specifies desired save name
```
save_loc = 'C:/Users/585000/Desktop/PCFSM/2017 KPIs/ASNs for google drive/'
save_name = "may_ASNS_test_6_26_v2.csv"
```

